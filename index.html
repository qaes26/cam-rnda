<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªØµÙˆÙŠØ± Ø§Ù„Ù‚Ù…Ø± ğŸŒ™</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #000;
            overflow: hidden;
            touch-action: manipulation; /* ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ */
        }
        
        #webcam {
            object-fit: cover;
            transform: scaleX(-1); /* Ø¬Ø¹Ù„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙƒÙ…Ø±Ø¢Ø© Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„Ø±Ø¤ÙŠØ© */
        }

        /* Ø²ÙˆØ§ÙŠØ§ Ø§Ù„ØªØ±ÙƒÙŠØ² (Focus Brackets) */
        .focus-bracket {
            position: absolute;
            width: 40px;
            height: 40px;
            border-color: rgba(255, 255, 255, 0.6);
            border-style: solid;
            transition: all 0.3s ease;
        }
        .top-left { top: 20%; left: 10%; border-width: 3px 0 0 3px; }
        .top-right { top: 20%; right: 10%; border-width: 3px 3px 0 0; }
        .bottom-left { bottom: 25%; left: 10%; border-width: 0 0 3px 3px; }
        .bottom-right { bottom: 25%; right: 10%; border-width: 0 3px 3px 0; }

        .pulsate {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 0.6; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); opacity: 0.6; }
        }

        /* Ø§Ù„ÙˆÙ…ÙŠØ¶ Ø§Ù„Ø£Ø¨ÙŠØ¶ Ø¹Ù†Ø¯ Ø§Ù„ØªØµÙˆÙŠØ± */
        #flash {
            pointer-events: none;
            transition: opacity 0.5s ease-out;
        }

        /* Ù†Ù‚Ø·Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ */
        .rec-dot {
            animation: blink 1s infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .typewriter-text {
            border-left: 2px solid white;
            white-space: nowrap;
            overflow: hidden;
            animation: typing 2s steps(40, end), blink-caret .75s step-end infinite;
        }
        
        @keyframes typing { from { width: 0 } to { width: 100% } }
        @keyframes blink-caret { from, to { border-color: transparent } 50% { border-color: white; } }

        .fade-in {
            animation: fadeIn 1s forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="relative w-screen h-screen text-white flex items-center justify-center">

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
    <div id="welcome-screen" class="absolute inset-0 z-50 flex flex-col items-center justify-center bg-[#050510] text-white p-6 text-center">
        <div class="text-7xl mb-6 animate-pulse drop-shadow-[0_0_15px_rgba(255,255,255,0.8)]">ğŸŒ•</div>
        <h1 class="text-3xl md:text-5xl font-bold mb-10 leading-tight">Ù‡ÙŠØ§ Ù„Ù†ØµÙˆØ± Ø§Ù„Ù‚Ù…Ø± ğŸŒ™</h1>
        <button id="start-btn" class="px-12 py-4 bg-white text-black font-bold rounded-full text-xl hover:scale-105 transition-transform shadow-[0_0_20px_rgba(255,255,255,0.4)]">
            Ø°Ù‡Ø§Ø¨ ğŸš€
        </button>
        <div class="absolute bottom-4 right-4 text-xs text-white/50 font-medium">
            Ù…Ù† Ø§Ø¹Ø¯Ø§Ø¯ Ù‚ÙŠØ³ Ø¬Ø§Ø²ÙŠ
        </div>
    </div>

    <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ ÙÙŠ Ø­Ø§Ù„ Ø¹Ø¯Ù… Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ -->
    <div id="error-msg" class="hidden absolute z-50 p-6 bg-red-600/90 rounded-2xl text-center shadow-xl mx-4">
        <h2 class="text-2xl font-bold mb-2">Ø¹Ø°Ø±Ø§Ù‹!</h2>
        <p>ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù„ÙƒÙŠ ÙŠØ¹Ù…Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØªØªÙ…ÙƒÙ†ÙŠ Ù…Ù† Ø±Ø¤ÙŠØ© Ø§Ù„Ø³Ø­Ø±.</p>
    </div>

    <!-- Ø­Ø§ÙˆÙŠØ© Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙˆØ§Ù„ÙˆØ§Ø¬Ù‡Ø© -->
    <div id="camera-container" class="hidden relative w-full h-full flex-col items-center justify-center">
        <!-- Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ø¨Ø« Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§) -->
        <video id="webcam" class="absolute inset-0 w-full h-full" autoplay playsinline></video>
        
        <!-- Ø·Ø¨Ù‚Ø© ØªØºÙ…ÙŠÙ‚ Ø®ÙÙŠÙØ© Ø¬Ø¯Ø§Ù‹ -->
        <div class="absolute inset-0 bg-black/10 pointer-events-none"></div>

        <!-- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ (ØªØ®ØªÙÙŠ Ø¹Ù†Ø¯ Ø§Ù„ØªØµÙˆÙŠØ±) -->
        <div id="camera-ui" class="absolute inset-0 z-10">
            <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
            <div class="absolute top-0 left-0 w-full p-6 flex justify-between items-start text-sm md:text-base font-medium drop-shadow-md">
                <div class="flex items-center gap-2">
                    <div class="w-3 h-3 rounded-full bg-red-500 rec-dot"></div>
                    <span class="tracking-widest">LIVE</span>
                </div>
                <div class="text-center">
                    <span class="block text-xs text-gray-300">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ</span>
                    <span class="font-bold text-yellow-400">Ø§Ù„ØªØµÙˆÙŠØ± Ø§Ù„ÙÙ„ÙƒÙŠ ğŸ”­</span>
                </div>
                <div class="flex items-center gap-1">
                    <span class="border border-white px-1 text-[10px] rounded">100%</span>
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M17 4h-3V2h-4v2H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2z"/></svg>
                </div>
            </div>

            <!-- Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„ØªØ±ÙƒÙŠØ² -->
            <div class="focus-bracket top-left pulsate"></div>
            <div class="focus-bracket top-right pulsate"></div>
            <div class="focus-bracket bottom-left pulsate"></div>
            <div class="focus-bracket bottom-right pulsate"></div>

            <!-- Ù†Øµ Ø¥Ø±Ø´Ø§Ø¯ÙŠ -->
            <div class="absolute bottom-32 w-full text-center drop-shadow-lg">
                <p class="text-white/80 text-sm md:text-base tracking-wide">ÙˆØ¬Ù‡ÙŠ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù„Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© Ù„Ù„Ù‚Ù…Ø±</p>
            </div>

            <!-- Ø²Ø± Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø· -->
            <div class="absolute bottom-10 left-1/2 -translate-x-1/2 flex flex-col items-center gap-2">
                <button id="capture-btn" class="w-20 h-20 rounded-full bg-white/30 border-4 border-white backdrop-blur-sm flex items-center justify-center transition-transform active:scale-90 hover:bg-white/50">
                    <div class="w-16 h-16 rounded-full bg-white"></div>
                </button>
            </div>
            
            <!-- ØªÙˆÙ‚ÙŠØ¹ Ù‚ÙŠØ³ -->
            <div class="absolute bottom-4 right-4 text-xs text-white/50 font-medium drop-shadow-md">
                Ù…Ù† Ø§Ø¹Ø¯Ø§Ø¯ Ù‚ÙŠØ³ Ø¬Ø§Ø²ÙŠ
            </div>
        </div>

        <!-- Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ (Ø§Ù„ÙÙ„Ø§Ø´) -->
        <div id="flash" class="absolute inset-0 bg-white opacity-0 z-20"></div>

        <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠØ© (ØªØ¸Ù‡Ø± Ø¨Ø¹Ø¯ Ø§Ù„ØªØµÙˆÙŠØ±) -->
        <div id="result-overlay" class="hidden absolute inset-0 z-30 bg-black/70 backdrop-blur-md flex flex-col items-center justify-center p-6 text-center">
            
            <div id="message-container" class="min-h-[150px] flex items-center justify-center flex-col gap-4">
                <div class="text-5xl mb-4 animate-bounce" id="moon-icon">ğŸ”­</div>
                <h1 id="dynamic-text" class="text-2xl md:text-4xl font-bold text-white leading-relaxed max-w-lg"></h1>
            </div>

            <button id="reset-btn" class="hidden mt-10 px-8 py-3 bg-white/10 hover:bg-white/20 border border-white/50 rounded-full transition-all text-sm backdrop-blur-sm">
                Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© Ø£Ø®Ø±Ù‰
            </button>
            
            <!-- ØªÙˆÙ‚ÙŠØ¹ Ù‚ÙŠØ³ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø£ÙŠØ¶Ø§Ù‹ -->
            <div class="absolute bottom-4 right-4 text-xs text-white/50 font-medium">
                Ù…Ù† Ø§Ø¹Ø¯Ø§Ø¯ Ù‚ÙŠØ³ Ø¬Ø§Ø²ÙŠ
            </div>
        </div>
    </div>

    <script>
        const video = document.getElementById('webcam');
        const captureBtn = document.getElementById('capture-btn');
        const flash = document.getElementById('flash');
        const cameraUi = document.getElementById('camera-ui');
        const resultOverlay = document.getElementById('result-overlay');
        const dynamicText = document.getElementById('dynamic-text');
        const moonIcon = document.getElementById('moon-icon');
        const resetBtn = document.getElementById('reset-btn');
        const errorMsg = document.getElementById('error-msg');
        
        // Ø¹Ù†Ø§ØµØ± Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
        const welcomeScreen = document.getElementById('welcome-screen');
        const startBtn = document.getElementById('start-btn');
        const cameraContainer = document.getElementById('camera-container');

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©
        async function initCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: "user" }, // Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©
                    audio: false 
                });
                video.srcObject = stream;
            } catch (err) {
                console.error("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§: ", err);
                cameraUi.style.display = 'none';
                errorMsg.classList.remove('hidden');
            }
        }

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªØªØ§Ø¨Ø¹
        const messages = [
            { text: "ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¯Ø§Ø± Ø§Ù„ÙÙ„ÙƒÙŠ...", icon: "ğŸ“¡", delay: 1000 },
            { text: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù‚Ù…Ø± Ø¨Ø§Ù„Ù…Ù†Ø·Ù‚Ø©...", icon: "ğŸ›°ï¸", delay: 2500 },
            { text: "ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù‡Ø¯Ù Ø¨Ù†Ø¬Ø§Ø­!", icon: "âœ¨", delay: 2500 },
            { text: "Ø£Ø±Ø¯Øª ØªØµÙˆÙŠØ± Ø§Ù„Ù‚Ù…Ø±...", icon: "ğŸ“¸", delay: 2000 },
            { text: "ÙÙˆØ¬Ø¯ØªÙƒÙ Ø£Ù†ØªÙ ÙŠØ§ Ø±Ù†Ø¯Ø§ ğŸŒ™â¤ï¸", icon: "ğŸ¥°", delay: 2500 }
        ];

        // ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø©
        captureBtn.addEventListener('click', () => {
            // ØªØ£Ø«ÙŠØ± Ø§Ù„ÙÙ„Ø§Ø´
            flash.style.opacity = '1';
            
            // Ø¥Ø®ÙØ§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙˆØªØ«Ø¨ÙŠØª Ø§Ù„ØµÙˆØ±Ø© (Ø¥ÙŠÙ‚Ø§Ù ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ø¤Ù‚ØªØ§Ù‹)
            setTimeout(() => {
                flash.style.opacity = '0';
                cameraUi.classList.add('hidden');
                video.pause(); // ØªØ«Ø¨ÙŠØª Ø§Ù„ØµÙˆØ±Ø©
                resultOverlay.classList.remove('hidden');
                resultOverlay.classList.add('flex');
                
                // Ø¨Ø¯Ø¡ Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
                playMessagesSequence();
            }, 500);
        });

        // ØªØ´ØºÙŠÙ„ Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
        function playMessagesSequence() {
            let delayAccumulator = 0;
            
            messages.forEach((msg, index) => {
                setTimeout(() => {
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Øµ ÙˆØ§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù…Ø¹ Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¸Ù‡ÙˆØ±
                    dynamicText.classList.remove('fade-in');
                    void dynamicText.offsetWidth; // Trigger reflow
                    
                    moonIcon.textContent = msg.icon;
                    dynamicText.innerHTML = msg.text;
                    
                    dynamicText.classList.add('fade-in');

                    // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø©ØŒ Ø£Ø¸Ù‡Ø± Ø²Ø± Ø§Ù„Ø¥Ø¹Ø§Ø¯Ø© ÙˆØ®Ù„ÙŠ Ø§Ù„Ù†Øµ Ø¨Ù„ÙˆÙ† Ù…Ù…ÙŠØ²
                    if (index === messages.length - 1) {
                        dynamicText.classList.add('text-yellow-300');
                        setTimeout(() => {
                            resetBtn.classList.remove('hidden');
                        }, 1000);
                    }
                }, delayAccumulator);
                
                delayAccumulator += msg.delay;
            });
        }

        // Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
        resetBtn.addEventListener('click', () => {
            resultOverlay.classList.add('hidden');
            resultOverlay.classList.remove('flex');
            cameraUi.classList.remove('hidden');
            dynamicText.classList.remove('text-yellow-300');
            resetBtn.classList.add('hidden');
            video.play(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        });

        // Ø²Ø± Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© (Ø°Ù‡Ø§Ø¨)
        startBtn.addEventListener('click', () => {
            welcomeScreen.classList.add('hidden');
            cameraContainer.classList.remove('hidden');
            cameraContainer.classList.add('flex');
            initCamera(); // Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø°Ù† ÙˆØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø±
        });
    </script>
</body>
</html>


